(this["webpackJsonpphp-cms-client"]=this["webpackJsonpphp-cms-client"]||[]).push([[0],{29:function(e,t,n){e.exports=n(47)},40:function(e,t,n){},41:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(18),c=n.n(u),i=n(5),s=n(2),o=n.n(s),l=n(6),f=n(1),p=n(3),h=n(15),m=function(){function e(t){Object(f.a)(this,e),this.status=200,this.success=!1,this.data=void 0,this.message="",this.data=t}return Object(p.a)(e,[{key:"deserialize",value:function(e){return this.status=parseInt(e.status),this.success=!!e.success,e.message&&(this.message="".concat(e.message)),this}}]),e}(),b=!0,E="https://jaspress.lichte.info/api",d="http://localhost:8073/Projects/jaspress-api/api",v=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,null,[{key:"get",value:function(t,n){return new Promise(function(){var r=Object(l.a)(o.a.mark((function r(a){var u,c,i;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(u=new URL("".concat(e.baseUrl).concat(t))).searchParams.delete("license"),u.searchParams.append("license",n),r.next=5,fetch(u.href,{headers:e.headers(),credentials:"include"});case 5:return c=r.sent,r.next=8,c.json();case 8:i=r.sent,a(new m(i).deserialize(i));case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}},{key:"post",value:function(t,n){return function(r){return new Promise(function(){var a=Object(l.a)(o.a.mark((function a(u){var c;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("".concat(e.baseUrl).concat(t),{method:"POST",body:JSON.stringify(Object(h.a)({},r,{license:n})),headers:e.headers(),credentials:"include"});case 2:return a.next=4,a.sent.json();case 4:c=a.sent,u(new m(c).deserialize(c));case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}}},{key:"makeGetRequest",value:function(){var t=Object(l.a)(o.a.mark((function t(n,r){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e.get(r,z.license).then((function(e){t(new m(n.deserialize(e.data.data)).deserialize(e))}))})));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"makePostRequest",value:function(){var t=Object(l.a)(o.a.mark((function t(n,r,a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){e.post(r,z.license)(a).then((function(e){t(new m(n.deserialize(e.data.data)).deserialize(e))}))})));case 1:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();v.baseUrl=b?E:d,v.headers=function(){return{}};var O=v,g=function(){function e(){Object(f.a)(this,e),this.key="",this.value="",this.defaultValue="",this.cssProperty=null}return Object(p.a)(e,[{key:"deserialize",value:function(e){return this.key=e.key,this.value=e.value,this.defaultValue=e.defaultValue,e.cssProperty&&(this.cssProperty=e.cssProperty),this}}]),e}(),j=function(){function e(){Object(f.a)(this,e),this.id=0,this.email="",this.isAdmin=!1}return Object(p.a)(e,[{key:"deserialize",value:function(e){return e?(e.id&&(this.id=parseInt(e.id)),e.email&&(this.email="".concat(e.email)),e.isAdmin&&(this.isAdmin=!!e.isAdmin),this):this}}]),e}(),y=function(){function e(){Object(f.a)(this,e),this.settings=[],this.user=null}return Object(p.a)(e,[{key:"deserialize",value:function(e){return e?(e.settings&&(this.settings=e.settings.map((function(e){return(new g).deserialize(e)}))),e.user&&(this.user=(new j).deserialize(e.user)),this):this}}]),e}(),w=function(){function e(){Object(f.a)(this,e),this.content="",this.htmlContent="",this.description=""}return Object(p.a)(e,[{key:"deserialize",value:function(e){return e.content&&(this.content=e.content),e.htmlContent&&(this.htmlContent=e.htmlContent),e.description&&(this.description=e.description),this}}]),e}(),S=function(){function e(){Object(f.a)(this,e),this.slug="",this.title="",this.markdown=null}return Object(p.a)(e,[{key:"deserialize",value:function(e){return this.slug=e.slug,this.title=e.title,this.markdown=(new w).deserialize(e.markdown),this}}]),e}(),R=function(){function e(){Object(f.a)(this,e),this.page=null}return Object(p.a)(e,[{key:"deserialize",value:function(e){return e?(e.page&&(this.page=(new S).deserialize(e.page)),this):this}}]),e}(),k=function(){function e(){Object(f.a)(this,e),this.baseApiUrl=""}return Object(p.a)(e,[{key:"deserialize",value:function(e){return e?(this.baseApiUrl="".concat(e.base_api_url),this):this}}]),e}(),T=function(){function e(){Object(f.a)(this,e),this.user=null}return Object(p.a)(e,[{key:"deserialize",value:function(e){return e?(e.user&&(this.user=(new j).deserialize(e.user)),this):this}}]),e}(),_=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,[{key:"deserialize",value:function(e){return this}}]),e}(),N=function(){function e(){Object(f.a)(this,e),this.user=null}return Object(p.a)(e,[{key:"deserialize",value:function(e){return e?(e.user&&(this.user=(new j).deserialize(e.user)),this):this}}]),e}(),z=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,null,[{key:"getConfig",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.makeGetRequest(new k,"/config/get.php"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"preflight",value:function(){var t=Object(l.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.license=n,t.abrupt("return",O.makeGetRequest(new y,"/preflight.php"));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getPage",value:function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.makeGetRequest(new R,"/page/get.php?p=".concat(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"doLogin",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.makePostRequest(new T,"/auth/login.php",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.makePostRequest(new N,"/auth/register.php",{email:t,password:n}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"doLogout",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",O.makeGetRequest(new _,"/auth/logout.php"));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();z.license="";var x,I=n(7);!function(e){e[e.SET_USER=0]="SET_USER",e[e.SET_SETTINGS=1]="SET_SETTINGS",e[e.SET_ERROR=2]="SET_ERROR"}(x||(x={}));var U,L=x,P=function(e){return e.user},C=function(e){return e.settings},A=function(e){return e.error};function V(e){var t,n=e.settings,r="html {\n        ".concat(n.filter((function(e){return null!=e.cssProperty})).map((function(e){return"".concat(e.cssProperty,": ").concat(e.value,";")})).join(""),"\n    }");return document.title=(null===(t=n.find((function(e){return"APP_NAME"===e.key})))||void 0===t?void 0:t.value)||"",a.a.createElement("style",null,r)}!function(e){e[e.INVALID_LICENSE=0]="INVALID_LICENSE",e[e.SERVER_ERROR=1]="SERVER_ERROR",e[e.NOT_FOUND=2]="NOT_FOUND"}(U||(U={}));var D=U;function G(e){switch(e){case 200:return null;case 404:return U.NOT_FOUND;case 500:return U.SERVER_ERROR}return U.SERVER_ERROR}function q(e){var t=function(e){switch(e){case D.INVALID_LICENSE:return a.a.createElement("p",null,"Invalid License!");case D.SERVER_ERROR:return a.a.createElement("p",null,"Unexpected Server error");case D.NOT_FOUND:return a.a.createElement("p",null,"Not found")}return a.a.createElement("p",null,"An error occurred")}(e.errorType);return a.a.createElement("section",null,t)}var F=n(11),J=n(13);function M(e){var t=e.onSubmit,n=Object(r.useState)(""),u=Object(i.a)(n,2),c=u[0],s=u[1],o=Object(r.useState)(""),l=Object(i.a)(o,2),f=l[0],p=l[1];return a.a.createElement("div",{className:"login-form"},a.a.createElement("input",{type:"email",value:c,onChange:function(e){return s(e.target.value)}}),a.a.createElement("input",{type:"password",value:f,onChange:function(e){return p(e.target.value)}}),a.a.createElement("button",{onClick:function(){return t(c,f)}},"Login"))}var B=function(){function e(){Object(f.a)(this,e)}return Object(p.a)(e,null,[{key:"login",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.doLogin(t,n);case 2:return r=e.sent,e.abrupt("return",r.data.user);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"register",value:function(){var e=Object(l.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.register(t,n);case 2:return r=e.sent,e.abrupt("return",r.data.user);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.doLogout();case 2:return t=e.sent,e.abrupt("return",200===t.status);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();function H(){var e=Object(r.useState)(null),t=Object(i.a)(e,2),n=t[0],u=t[1],c=Object(I.b)(),s=Object(J.g)();return Object(r.useEffect)((function(){c({type:L.SET_USER,user:n})}),[n,c]),a.a.createElement("div",{className:"login-page"},a.a.createElement(M,{onSubmit:function(e,t){B.login(e,t).then((function(e){u(e),s.push("/")}))}}),a.a.createElement(F.b,{to:"/auth/register"},"Sign up instead"))}function K(){var e=Object(r.useState)(!0),t=Object(i.a)(e,2),n=t[0],u=t[1],c=Object(I.b)();return Object(r.useEffect)((function(){B.logout().then((function(e){e&&c({type:L.SET_USER,user:null}),u(!1)}))}),[c]),n?a.a.createElement(a.a.Fragment,null):a.a.createElement(J.a,{to:"/"})}function Q(e){var t=e.onSubmit,n=Object(r.useState)(""),u=Object(i.a)(n,2),c=u[0],s=u[1],o=Object(r.useState)(""),l=Object(i.a)(o,2),f=l[0],p=l[1];return a.a.createElement("div",{className:"login-form"},a.a.createElement("input",{type:"email",value:c,onChange:function(e){return s(e.target.value)}}),a.a.createElement("input",{type:"password",value:f,onChange:function(e){return p(e.target.value)}}),a.a.createElement("button",{onClick:function(){return t(c,f)}},"Login"))}function W(){var e=Object(r.useState)(null),t=Object(i.a)(e,2),n=t[0],u=t[1],c=Object(I.b)(),s=Object(J.g)();return Object(r.useEffect)((function(){c({type:L.SET_USER,user:n})}),[n,c]),a.a.createElement("div",{className:"register-page"},a.a.createElement(Q,{onSubmit:function(e,t){B.register(e,t).then((function(e){u(e),s.push("/")}))}}),a.a.createElement(F.b,{to:"/auth/login"},"Log in instead"))}var X=function(){var e=Object(J.h)().path;return a.a.createElement(J.d,null,a.a.createElement(J.b,{path:"".concat(e,"/login")},a.a.createElement(H,null)),a.a.createElement(J.b,{path:"".concat(e,"/register")},a.a.createElement(W,null)),a.a.createElement(J.b,{path:"".concat(e,"/logout")},a.a.createElement(K,null)),a.a.createElement(J.b,{path:"".concat(e,"/*")},a.a.createElement(q,{errorType:D.NOT_FOUND})))};n(40);function Y(){var e=Object(I.c)(P);return a.a.createElement("div",{className:"home-page"},a.a.createElement("nav",null,null!=e?a.a.createElement("div",null,a.a.createElement("p",null,null===e||void 0===e?void 0:e.email),a.a.createElement(F.b,{to:"/auth/logout"},"logout")):a.a.createElement(F.b,{to:"/auth/login"},"Login")))}function Z(){return a.a.createElement(F.a,null,a.a.createElement(J.d,null,a.a.createElement(J.b,{path:"/auth"},a.a.createElement(X,null)),a.a.createElement(J.b,{exact:!0,path:"/"},a.a.createElement(Y,null)),a.a.createElement(J.b,{path:"*"},a.a.createElement(q,{errorType:D.NOT_FOUND}))))}n(41);var $=n(28),ee=n.n($);n(46);function te(e){var t=e.color,n=e.loading,u=e.delayMs,c=Object(r.useState)(n),s=Object(i.a)(c,2),o=s[0],l=s[1];return Object(r.useEffect)((function(){n||setTimeout((function(){return l(!1)}),u||0)}),[n,u]),a.a.createElement("div",{className:"loading loading-fs","data-active":o?"yes":"no"},a.a.createElement(ee.a,{color:t,loading:!0,size:25}))}function ne(e){var t=e.license,n=Object(I.b)(),u=Object(I.c)(C),c=Object(I.c)(A),s=Object(r.useState)(!0),o=Object(i.a)(s,2),l=o[0],f=o[1];return Object(r.useEffect)((function(){t?z.getConfig().then((function(e){200!==e.status?n({type:L.SET_ERROR,error:G(e.status)}):(O.baseUrl=e.data.baseApiUrl,z.preflight(t).then(function(e){return function(t){200===t.status?(e({type:L.SET_SETTINGS,settings:t.data.settings}),e({type:L.SET_USER,user:t.data.user})):e({type:L.SET_ERROR,error:401===t.status?D.INVALID_LICENSE:G(t.status)})}}(n)))})):n({type:L.SET_ERROR,error:D.INVALID_LICENSE})}),[n,t]),Object(r.useEffect)((function(){null!=u&&f(!1)}),[u]),null!=c?a.a.createElement(q,{errorType:c}):a.a.createElement(a.a.Fragment,null,null!=u&&a.a.createElement(V,{settings:u}),a.a.createElement(te,{color:"#f00",loading:l}),!l&&a.a.createElement(Z,null))}var re=function e(){Object(f.a)(this,e),this.user=null,this.settings=null,this.error=null},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L.SET_USER:return Object(h.a)({},e,{user:t.user});case L.SET_SETTINGS:return Object(h.a)({},e,{settings:t.settings});case L.SET_ERROR:return Object(h.a)({},e,{error:t.error})}return e},ue=n(20),ce=Object(ue.b)(ae);c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(I.a,{store:ce},a.a.createElement(ne,{license:"123"}))),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.3dab690d.chunk.js.map